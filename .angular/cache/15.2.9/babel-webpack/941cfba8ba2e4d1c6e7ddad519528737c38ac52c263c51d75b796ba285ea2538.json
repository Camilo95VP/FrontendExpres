{"ast":null,"code":"import Swal from 'sweetalert2';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/torre.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"ngx-toastr\";\nimport * as i4 from \"@angular/common\";\nfunction ListarTorresComponent_tr_29_button_20_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function ListarTorresComponent_tr_29_button_20_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const torre_r1 = i0.ɵɵnextContext().$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.editarTorre(torre_r1._id));\n    });\n    i0.ɵɵtext(1, \"Editar\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ListarTorresComponent_tr_29_button_21_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 12);\n    i0.ɵɵlistener(\"click\", function ListarTorresComponent_tr_29_button_21_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const torre_r1 = i0.ɵɵnextContext().$implicit;\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.enviarMensaje(torre_r1));\n    });\n    i0.ɵɵtext(1, \"Enviar \\uD83D\\uDCE9\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ListarTorresComponent_tr_29_button_22_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function ListarTorresComponent_tr_29_button_22_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const torre_r1 = i0.ɵɵnextContext().$implicit;\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.eliminarTorre(torre_r1._id));\n    });\n    i0.ɵɵtext(1, \"Eliminar\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ListarTorresComponent_tr_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"td\");\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"td\");\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"td\");\n    i0.ɵɵtext(17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"td\")(19, \"div\", 7);\n    i0.ɵɵtemplate(20, ListarTorresComponent_tr_29_button_20_Template, 2, 0, \"button\", 8);\n    i0.ɵɵtemplate(21, ListarTorresComponent_tr_29_button_21_Template, 2, 0, \"button\", 9);\n    i0.ɵɵtemplate(22, ListarTorresComponent_tr_29_button_22_Template, 2, 0, \"button\", 10);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const torre_r1 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(torre_r1.residencia);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(torre_r1.nombre);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(torre_r1.apto);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(9, 11, torre_r1.fecha));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(torre_r1.nombrePersona);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(torre_r1.celular);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(torre_r1.nivelInfestacion);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(torre_r1.recomendaciones);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", torre_r1._id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", torre_r1._id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", torre_r1._id);\n  }\n}\nexport let ListarTorresComponent = /*#__PURE__*/(() => {\n  class ListarTorresComponent {\n    constructor(torresService, router, toastr) {\n      this.torresService = torresService;\n      this.router = router;\n      this.toastr = toastr;\n      this.torres = [];\n    }\n    ngOnInit() {\n      this.obtenerTorres();\n    }\n    obtenerTorres() {\n      this.torresService.obtenerTorres().subscribe(torres => {\n        this.torres = torres;\n      }, error => {\n        console.log('Error al obtener las torres:', error);\n      });\n    }\n    editarTorre(torreId) {\n      if (torreId !== null) {\n        console.log(torreId);\n        this.router.navigate(['/editar-torre', torreId]);\n      }\n    }\n    enviarMensaje(torre) {\n      const nombre = torre.nombrePersona;\n      const fecha = torre.fecha;\n      const nivelInfestacion = torre.nivelInfestacion;\n      const recomendaciones = torre.recomendaciones;\n      const mensaje = ` *Certificado fumigación:*\n      ¡Hola ${nombre}! De acuerdo al servicio realizado para el control de plagas el día *${fecha}*, evidenciamos un nivel de infestación: *${nivelInfestacion}. \n      Recuerda la importancia de seguir con el orden y de fumigar periódicamente. \n  \n      Si el técnico evidenció que no tienes infestación, recuerda que es normal seguir viendo cucarachas y otros animalitos, ya que estos serán solo de paso y no se quedarán en tu hogar gracias a las propiedades piretroides del veneno. \n  \n      De lo contrario, si se evidenció infestación, te aconsejamos llamarnos para una nueva fumigación. \n      Recomendaciones: *${recomendaciones}*, si tienes alguna inquietud nos puedes escribir a este número,\n      Recuerda que realizamos servicios para: fincas, apartamentos, locales, bodegas, empresas, oficinas, hospitales, transporte público, etc.\n      Cordialmente: Expres Fumigaciones. ¡Feliz día! ©\n    `;\n      const numeroTelefono = torre.celular;\n      Swal.fire({\n        title: 'Por favor continua a wpp y verifica que los datos del mensaje esten bien antes de enviarlo',\n        text: 'Se enviará un mensaje de WhatsApp al cliente con la información del servicio.',\n        icon: 'question',\n        showCancelButton: true,\n        confirmButtonText: 'Continuar al wpp',\n        cancelButtonText: 'Cancelar',\n        customClass: {\n          confirmButton: 'swal2-confirm',\n          cancelButton: 'swal2-cancel'\n        },\n        background: '#ffffff'\n      }).then(result => {\n        if (result.isConfirmed) {\n          if (numeroTelefono) {\n            const enlaceWhatsApp = `https://wa.me/${numeroTelefono}?text=${encodeURIComponent(String(mensaje))}`;\n            window.open(enlaceWhatsApp, '_blank');\n          } else {\n            this.toastr.error('No se encontró un número de teléfono válido para esta torre.', 'Error');\n          }\n        }\n      });\n    }\n    eliminarTorre(torreId) {\n      if (torreId) {\n        Swal.fire({\n          title: '¿Estás seguro?',\n          text: 'Esta acción no se puede deshacer',\n          icon: 'warning',\n          showCancelButton: true,\n          confirmButtonText: 'Sí, eliminar',\n          cancelButtonText: 'Cancelar'\n        }).then(result => {\n          if (result.isConfirmed) {\n            // Lógica de eliminación aquí\n            // Llama al servicio para eliminar la torre\n            this.torresService.eliminarTorre(torreId).subscribe(() => {\n              // Eliminación exitosa\n              Swal.fire('Eliminada', 'La torre ha sido eliminada con éxito', 'success');\n              // Actualizar la lista de torres después de eliminar\n              this.obtenerTorres();\n            }, error => {\n              console.log('Error al eliminar la torre:', error);\n            });\n          }\n        });\n      }\n    }\n  }\n  ListarTorresComponent.ɵfac = function ListarTorresComponent_Factory(t) {\n    return new (t || ListarTorresComponent)(i0.ɵɵdirectiveInject(i1.TorresService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.ToastrService));\n  };\n  ListarTorresComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ListarTorresComponent,\n    selectors: [[\"app-listar-torres\"]],\n    decls: 30,\n    vars: 1,\n    consts: [[1, \"custom-container\", \"mt-5\", 2, \"width\", \"90%\", \"margin\", \"0 auto\"], [1, \"head-form\"], [\"routerLink\", \"/servicio-torres\", 1, \"btn\", \"btn-primary\", \"float-end\"], [\"aria-hidden\", \"true\", 1, \"fa\", \"fa-plus\"], [1, \"table\"], [1, \"trs\"], [4, \"ngFor\", \"ngForOf\"], [1, \"accionesbtn\"], [\"class\", \"btn\", \"id\", \"editar\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"btn\", \"id\", \"guardar\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"btn\", \"id\", \"eliminar\", 3, \"click\", 4, \"ngIf\"], [\"id\", \"editar\", 1, \"btn\", 3, \"click\"], [\"id\", \"guardar\", 1, \"btn\", 3, \"click\"], [\"id\", \"eliminar\", 1, \"btn\", 3, \"click\"]],\n    template: function ListarTorresComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h2\");\n        i0.ɵɵtext(3, \"Servicios\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"button\", 2);\n        i0.ɵɵelement(5, \"i\", 3);\n        i0.ɵɵtext(6, \" Nuevo registro\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(7, \"table\", 4)(8, \"thead\")(9, \"tr\", 5)(10, \"th\");\n        i0.ɵɵtext(11, \"Residencia\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"th\");\n        i0.ɵɵtext(13, \"# Torre\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"th\");\n        i0.ɵɵtext(15, \"# Apto\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"th\");\n        i0.ɵɵtext(17, \"Fecha\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"th\");\n        i0.ɵɵtext(19, \"Nombre\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"th\");\n        i0.ɵɵtext(21, \"Celular\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"th\");\n        i0.ɵɵtext(23, \"Nivel de Infestaci\\u00F3n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"th\");\n        i0.ɵɵtext(25, \"Recomendaciones\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"th\");\n        i0.ɵɵtext(27, \"Acciones\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(28, \"tbody\");\n        i0.ɵɵtemplate(29, ListarTorresComponent_tr_29_Template, 23, 13, \"tr\", 6);\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(29);\n        i0.ɵɵproperty(\"ngForOf\", ctx.torres);\n      }\n    },\n    dependencies: [i4.NgForOf, i4.NgIf, i2.RouterLink, i4.DatePipe],\n    styles: [\".custom-container[_ngcontent-%COMP%]{box-shadow:0 0 11px 3px #00000056!important;background-color:#0000006c;color:#fff!important;padding:20px}.table[_ngcontent-%COMP%]{color:#fff}h2[_ngcontent-%COMP%]{width:20%}.head-form[_ngcontent-%COMP%]{display:flex;padding:10px;justify-content:space-between;border-radius:10px}.btn[_ngcontent-%COMP%]{position:relative;font-size:12px;text-transform:uppercase;text-decoration:none;display:inline-block;border-radius:5px;transition:all .2s;border:none;font-family:inherit;font-weight:500;color:#000;background-color:#fff;cursor:pointer}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 10px 20px #ececec14}.btn[_ngcontent-%COMP%]:active{transform:translateY(-1px);box-shadow:0 5px 10px #d1d1d133}.btn[_ngcontent-%COMP%]:after{content:\\\"\\\";display:inline-block;height:90%;width:90%;border-radius:100px;position:absolute;top:0;left:0;z-index:-1;transition:all .4s}.btn[_ngcontent-%COMP%]:after{background-color:#f7f7f730}.btn[_ngcontent-%COMP%]:hover:after{transform:scaleX(1.4) scaleY(1.6);opacity:0}#guardar[_ngcontent-%COMP%]{background-color:green;color:#fff;height:30px}#cancelar[_ngcontent-%COMP%]{background-color:#e0d100;color:#000;height:30px}#editar[_ngcontent-%COMP%]{background-color:#0069f2;color:#fff;height:30px}#eliminar[_ngcontent-%COMP%]{background-color:#ff000093;color:#fff;height:30px}#verregistros[_ngcontent-%COMP%]{background-color:#0072b8;color:#fff;height:30px}.accionesbtn[_ngcontent-%COMP%]{display:grid;gap:8px}.table[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(caption) > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:.5rem;color:var(--bs-table-color-state,var(--bs-table-color-type,var(--bs-table-color)));background-color:#0000006d;color:#fff;border-bottom-width:var(--bs-border-width);box-shadow:inset 0 0 0 9999px var(--bs-table-bg-state,var(--bs-table-bg-type,var(--bs-table-accent-bg)))}\"]\n  });\n  return ListarTorresComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}